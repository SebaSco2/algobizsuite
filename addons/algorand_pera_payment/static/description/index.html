<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils: https://docutils.sourceforge.io/" />
<title>README.rst</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 9511 2024-01-13 09:50:07Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.
Despite the name, some widely supported CSS2 features are used.

See https://docutils.sourceforge.io/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

.subscript {
  vertical-align: sub;
  font-size: smaller }

.superscript {
  vertical-align: super;
  font-size: smaller }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left, table.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right, table.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

table.align-center {
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

.align-top    {
  vertical-align: top }

.align-middle {
  vertical-align: middle }

.align-bottom {
  vertical-align: bottom }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: gray; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic, pre.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document">


<a class="reference external image-reference" href="https://odoo-community.org/get-involved?utm_source=readme">
<img alt="Odoo Community Association" src="https://odoo-community.org/readme-banner-image" />
</a>
<div class="section" id="payment-algorand-pera-wallet">
<h1>Payment - Algorand (Pera Wallet)</h1>
<!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!! This file is generated by oca-gen-addon-readme !!
!! changes will be overwritten.                   !!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!! source digest: sha256:02643a792fe1dfea9c9d5c2eef49ed0c9870b34ae04d8d9462e36dd3eb06cce3
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
<p><a class="reference external image-reference" href="https://odoo-community.org/page/development-status"><img alt="Beta" src="https://img.shields.io/badge/maturity-Beta-yellow.png" /></a> <a class="reference external image-reference" href="http://www.gnu.org/licenses/agpl-3.0-standalone.html"><img alt="License: AGPL-3" src="https://img.shields.io/badge/license-AGPL--3-blue.png" /></a> <a class="reference external image-reference" href="https://github.com/OCA/algobizsuite/tree/19.0/algorand_pera_payment"><img alt="OCA/algobizsuite" src="https://img.shields.io/badge/github-OCA%2Falgobizsuite-lightgray.png?logo=github" /></a> <a class="reference external image-reference" href="https://translation.odoo-community.org/projects/algobizsuite-19-0/algobizsuite-19-0-algorand_pera_payment"><img alt="Translate me on Weblate" src="https://img.shields.io/badge/weblate-Translate%20me-F47D42.png" /></a> <a class="reference external image-reference" href="https://runboat.odoo-community.org/builds?repo=OCA/algobizsuite&amp;target_branch=19.0"><img alt="Try me on Runboat" src="https://img.shields.io/badge/runboat-Try%20me-875A7B.png" /></a></p>
<p>This module adds support for Algorand blockchain payments through Pera
Wallet to Odoo’s e-commerce platform.</p>
<p>Pera Wallet is a secure, open-source, non-custodial wallet for the
Algorand blockchain that allows users to manage their Algorand (ALGO)
assets and Algorand Standard Assets (ASAs) like USDC.</p>
<p>Key Features:</p>
<ul class="simple">
<li>Accept payments in ALGO (Algorand’s native cryptocurrency)</li>
<li>Accept payments in USDC (via Algorand Standard Assets)</li>
<li>Direct wallet-to-wallet transactions without intermediaries</li>
<li>Low transaction fees (typically less than $0.01)</li>
<li>Fast confirmation times (under 5 seconds)</li>
<li>Secure blockchain-based payment verification</li>
<li>Automatic order confirmation upon payment</li>
<li>Seamless integration with Odoo’s e-commerce workflow</li>
</ul>
<p>Technical Highlights:</p>
<ul class="simple">
<li>Follows Odoo’s standard payment provider patterns</li>
<li>Automatic cart clearing after successful payment</li>
<li>Transaction monitoring on /payment/status page</li>
<li>Built-in USDC opt-in verification for both merchant and customer</li>
<li>Comprehensive error handling and user feedback</li>
<li>OCA compliant module structure</li>
</ul>
<p>Why Algorand?</p>
<ul class="simple">
<li>Low fees: Transaction costs are typically under $0.01</li>
<li>Fast: Block times of ~3.7 seconds for near-instant confirmation</li>
<li>Scalable: Handles 6,000+ transactions per second</li>
<li>Eco-friendly: Carbon-negative blockchain</li>
<li>Secure: Pure proof-of-stake consensus with strong finality guarantees</li>
</ul>
<p><strong>Table of contents</strong></p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#installation" id="toc-entry-1">Installation</a></li>
<li><a class="reference internal" href="#prerequisites" id="toc-entry-2">Prerequisites</a></li>
<li><a class="reference internal" href="#installation-steps" id="toc-entry-3">Installation Steps</a></li>
<li><a class="reference internal" href="#post-installation-configuration" id="toc-entry-4">Post-Installation Configuration</a><ul>
<li><a class="reference internal" href="#step-1-basic-configuration" id="toc-entry-5">Step 1: Basic Configuration</a></li>
<li><a class="reference internal" href="#step-2-verify-configuration" id="toc-entry-6">Step 2: Verify Configuration</a></li>
<li><a class="reference internal" href="#step-3-enable-provider" id="toc-entry-7">Step 3: Enable Provider</a></li>
</ul>
</li>
<li><a class="reference internal" href="#validation-rules" id="toc-entry-8">Validation Rules</a></li>
<li><a class="reference internal" href="#accepting-different-currencies" id="toc-entry-9">Accepting Different Currencies</a></li>
<li><a class="reference internal" href="#testing-your-setup" id="toc-entry-10">Testing Your Setup</a></li>
<li><a class="reference internal" href="#troubleshooting" id="toc-entry-11">Troubleshooting</a></li>
<li><a class="reference internal" href="#configuration" id="toc-entry-12">Configuration</a></li>
<li><a class="reference internal" href="#merchant-address-configuration-required" id="toc-entry-13">Merchant Address Configuration (Required)</a></li>
<li><a class="reference internal" href="#network-configuration" id="toc-entry-14">Network Configuration</a><ul>
<li><a class="reference internal" href="#testnet-for-testing" id="toc-entry-15">TestNet (for testing)</a></li>
<li><a class="reference internal" href="#mainnet-for-production" id="toc-entry-16">MainNet (for production)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usdc-payments-usd-currency" id="toc-entry-17">USDC Payments (USD Currency)</a><ul>
<li><a class="reference internal" href="#checking-usdc-opt-in-status" id="toc-entry-18">Checking USDC Opt-in Status</a></li>
<li><a class="reference internal" href="#usdc-asset-ids" id="toc-entry-19">USDC Asset IDs</a></li>
<li><a class="reference internal" href="#how-to-opt-in-to-usdc" id="toc-entry-20">How to Opt-in to USDC</a></li>
</ul>
</li>
<li><a class="reference internal" href="#validation-and-error-handling" id="toc-entry-21">Validation and Error Handling</a></li>
<li><a class="reference internal" href="#security-considerations" id="toc-entry-22">Security Considerations</a></li>
<li><a class="reference internal" href="#usage" id="toc-entry-23">Usage</a></li>
<li><a class="reference internal" href="#customer-experience" id="toc-entry-24">Customer Experience</a></li>
<li><a class="reference internal" href="#payment-flow-architecture" id="toc-entry-25">Payment Flow Architecture</a></li>
<li><a class="reference internal" href="#supported-payment-types" id="toc-entry-26">Supported Payment Types</a></li>
<li><a class="reference internal" href="#transaction-verification" id="toc-entry-27">Transaction Verification</a></li>
<li><a class="reference internal" href="#error-handling" id="toc-entry-28">Error Handling</a></li>
<li><a class="reference internal" href="#admin-features" id="toc-entry-29">Admin Features</a></li>
<li><a class="reference internal" href="#security-best-practices" id="toc-entry-30">Security Best Practices</a></li>
<li><a class="reference internal" href="#changelog" id="toc-entry-31">Changelog</a></li>
<li><a class="reference internal" href="#section-1" id="toc-entry-32">19.0.1.0.0 (2025-10-17)</a><ul>
<li><a class="reference internal" href="#core-features" id="toc-entry-33">Core Features:</a></li>
<li><a class="reference internal" href="#payment-flow" id="toc-entry-34">Payment Flow:</a></li>
<li><a class="reference internal" href="#code-quality" id="toc-entry-35">Code Quality:</a></li>
<li><a class="reference internal" href="#technical-implementation" id="toc-entry-36">Technical Implementation:</a></li>
<li><a class="reference internal" href="#security-validation" id="toc-entry-37">Security &amp; Validation:</a></li>
<li><a class="reference internal" href="#admin-features-1" id="toc-entry-38">Admin Features:</a></li>
<li><a class="reference internal" href="#documentation" id="toc-entry-39">Documentation:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#bug-tracker" id="toc-entry-40">Bug Tracker</a></li>
<li><a class="reference internal" href="#credits" id="toc-entry-41">Credits</a><ul>
<li><a class="reference internal" href="#contributors" id="toc-entry-42">Contributors</a></li>
<li><a class="reference internal" href="#maintainers" id="toc-entry-43">Maintainers</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="installation">
<h2><a class="toc-backref" href="#toc-entry-1">Installation</a></h2>
</div>
<div class="section" id="prerequisites">
<h2><a class="toc-backref" href="#toc-entry-2">Prerequisites</a></h2>
<p><strong>Required Python Package</strong>:</p>
<pre class="code bash literal-block">
pip<span class="w"> </span>install<span class="w"> </span>algosdk
</pre>
<p>The <tt class="docutils literal">algosdk</tt> package is required for Algorand blockchain interaction
(transaction building, address validation, and blockchain verification).</p>
<p><strong>Required for Merchant</strong>:</p>
<ul class="simple">
<li>An Algorand wallet address to receive payments</li>
<li>Access to Pera Wallet (mobile app or web) to manage your merchant
wallet</li>
</ul>
<p><strong>Recommended for Testing</strong>:</p>
<ul class="simple">
<li>A TestNet Algorand wallet</li>
<li>TestNet ALGO from the faucet: <a class="reference external" href="https://bank.testnet.algorand.network/">https://bank.testnet.algorand.network/</a></li>
</ul>
</div>
<div class="section" id="installation-steps">
<h2><a class="toc-backref" href="#toc-entry-3">Installation Steps</a></h2>
<ol class="arabic simple">
<li><strong>Install via Odoo Apps Menu</strong>:<ul>
<li>Navigate to <strong>Apps</strong></li>
<li>Search for “Algorand Pera Payment”</li>
<li>Click <strong>Install</strong></li>
</ul>
</li>
<li><strong>Automatic Setup</strong>:<ul>
<li>The module automatically creates:<ul>
<li>Payment provider record (Algorand Pera Wallet)</li>
<li>Payment method record (algorand_pera)</li>
<li>Account payment method (for journal integration)</li>
</ul>
</li>
<li>Provider is created in <strong>disabled</strong> state by default</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="post-installation-configuration">
<h2><a class="toc-backref" href="#toc-entry-4">Post-Installation Configuration</a></h2>
<p>The provider <strong>MUST</strong> be configured before it can be enabled. Follow
these steps:</p>
<div class="section" id="step-1-basic-configuration">
<h3><a class="toc-backref" href="#toc-entry-5">Step 1: Basic Configuration</a></h3>
<ol class="arabic">
<li><p class="first">Go to <strong>Website &gt; Configuration &gt; Payment Providers</strong></p>
</li>
<li><p class="first">Select <strong>Algorand Pera Wallet</strong></p>
</li>
<li><p class="first">Configure required settings:</p>
<p><strong>Merchant Algorand Address</strong> (Required):</p>
<ul class="simple">
<li>Your 58-character Algorand wallet address</li>
<li>Format: Uppercase letters and numbers (e.g., <tt class="docutils literal"><span class="pre">ABC123...XYZ789</span></tt>)</li>
<li>This is where you will receive payments</li>
<li><strong>Validation</strong>: Module checks address format and length</li>
</ul>
<p><strong>Algorand Network</strong>:</p>
<ul class="simple">
<li><strong>TestNet</strong>: For testing (default)</li>
<li><strong>MainNet</strong>: For production</li>
</ul>
<p><strong>Algorand Node URL</strong>:</p>
<ul class="simple">
<li>TestNet: <tt class="docutils literal"><span class="pre">https://testnet-api.algonode.cloud</span></tt> (default)</li>
<li>MainNet: <tt class="docutils literal"><span class="pre">https://mainnet-api.algonode.cloud</span></tt></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="step-2-verify-configuration">
<h3><a class="toc-backref" href="#toc-entry-6">Step 2: Verify Configuration</a></h3>
<p>Before enabling, verify your setup:</p>
<ol class="arabic simple">
<li><strong>Verify Node Connection</strong>:<ul>
<li>Click the <strong>“Verify Node”</strong> button</li>
<li>Confirms node URL is accessible</li>
<li>Checks Algorand network connectivity</li>
</ul>
</li>
<li><strong>Check USDC Opt-in</strong> (for USD payments):<ul>
<li>Click <strong>“Check USDC Opt-in Status”</strong> button</li>
<li>Verifies if your merchant address is opted-in to USDC</li>
<li>Required for accepting USD payments</li>
<li>Optional for ALGO payments</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="step-3-enable-provider">
<h3><a class="toc-backref" href="#toc-entry-7">Step 3: Enable Provider</a></h3>
<ol class="arabic simple">
<li><strong>Set State</strong>:<ul>
<li>Change <strong>State</strong> from “Disabled” to “Enabled” or “Test”</li>
<li>Module validates merchant address at this point</li>
<li>Validation errors will prevent enabling</li>
</ul>
</li>
<li><strong>Publish Provider</strong>:<ul>
<li>Click the <strong>“Published”</strong> smart button in the header</li>
<li>Makes provider visible to customers</li>
<li>Provider must be enabled before publishing</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="section" id="validation-rules">
<h2><a class="toc-backref" href="#toc-entry-8">Validation Rules</a></h2>
<p>The module enforces strict validation:</p>
<p><strong>Hard Requirements</strong> (Prevents Enabling):</p>
<ul class="simple">
<li>❌ Merchant address must be configured</li>
<li>❌ Merchant address must be exactly 58 characters</li>
<li>❌ Merchant address must have valid format</li>
<li>❌ State cannot be ‘enabled’ or ‘test’ without valid merchant address</li>
</ul>
<p><strong>Warnings</strong> (Does Not Prevent Enabling):</p>
<ul class="simple">
<li>⚠️ Merchant not opted-in to USDC → Cannot accept USD payments</li>
<li>⚠️ Still allows ALGO payments</li>
</ul>
</div>
<div class="section" id="accepting-different-currencies">
<h2><a class="toc-backref" href="#toc-entry-9">Accepting Different Currencies</a></h2>
<p><strong>ALGO Payments</strong> (Always Available):</p>
<ul class="simple">
<li>No special configuration needed</li>
<li>Works immediately after enabling provider</li>
<li>Merchant address is all that’s required</li>
</ul>
<p><strong>USD/USDC Payments</strong> (Requires Opt-in):</p>
<ol class="arabic simple">
<li>Your merchant address must be opted-in to USDC asset</li>
<li>Use <strong>“Check USDC Opt-in Status”</strong> button to verify</li>
<li>To opt-in:<ul>
<li>Open Pera Wallet</li>
<li>Go to “Add Asset”</li>
<li>Search for “USDC”</li>
<li>Verify Asset ID:<ul>
<li>MainNet: <tt class="docutils literal">31566704</tt> (Circle USDC)</li>
<li>TestNet: <tt class="docutils literal">10458941</tt> (Test USDC)</li>
</ul>
</li>
<li>Complete opt-in transaction (requires small ALGO for fee)</li>
</ul>
</li>
<li>After opt-in, click <strong>“Check USDC Opt-in Status”</strong> again to confirm</li>
</ol>
</div>
<div class="section" id="testing-your-setup">
<h2><a class="toc-backref" href="#toc-entry-10">Testing Your Setup</a></h2>
<p><strong>Before Going Live</strong>:</p>
<ol class="arabic simple">
<li><strong>Use TestNet First</strong>:<ul>
<li>Configure provider with TestNet settings</li>
<li>Use TestNet merchant address</li>
<li>Test full payment flow</li>
<li>Get free TestNet ALGO from faucet</li>
</ul>
</li>
<li><strong>Test Payment Flow</strong>:<ul>
<li>Add product to cart</li>
<li>Go to checkout</li>
<li>Select Algorand Pera Wallet</li>
<li>Connect wallet</li>
<li>Complete test payment</li>
<li>Verify order confirmation</li>
<li>Check payment in Pera Wallet history</li>
</ul>
</li>
<li><strong>Verify in Odoo</strong>:<ul>
<li>Check payment.transaction record</li>
<li>Verify Algorand transaction ID stored</li>
<li>Check sale order is confirmed</li>
<li>Verify account.payment created (if applicable)</li>
</ul>
</li>
<li><strong>Switch to MainNet</strong>:<ul>
<li>Update Network to MainNet</li>
<li>Update Node URL to MainNet</li>
<li>Update Merchant Address to MainNet address</li>
<li>Re-verify USDC opt-in for MainNet</li>
<li>Test with small real payment first</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="troubleshooting">
<h2><a class="toc-backref" href="#toc-entry-11">Troubleshooting</a></h2>
<p><strong>Cannot Enable Provider</strong>:</p>
<ul class="simple">
<li>Check merchant address is exactly 58 characters</li>
<li>Verify address format (no spaces, special characters)</li>
<li>Check provider state transitions (disabled → test/enabled)</li>
</ul>
<p><strong>USDC Payments Not Working</strong>:</p>
<ul class="simple">
<li>Verify merchant opted-in using “Check USDC Opt-in Status”</li>
<li>Verify correct Asset ID for your network (TestNet vs MainNet)</li>
<li>Check customer also has USDC opt-in</li>
</ul>
<p><strong>Node Connection Fails</strong>:</p>
<ul class="simple">
<li>Verify Node URL is correct</li>
<li>Check internet connectivity</li>
<li>Try alternative node URLs:<ul>
<li>AlgoNode: <tt class="docutils literal"><span class="pre">https://testnet-api.algonode.cloud</span></tt></li>
<li>PureStake: <tt class="docutils literal"><span class="pre">https://testnet-algorand.api.purestake.io/ps2</span></tt></li>
</ul>
</li>
</ul>
<p><strong>Module Installation Issues</strong>:</p>
<ul class="simple">
<li>Verify <tt class="docutils literal">algosdk</tt> package is installed</li>
<li>Check Python version compatibility (3.8+)</li>
<li>Review Odoo logs for errors</li>
</ul>
</div>
<div class="section" id="configuration">
<h2><a class="toc-backref" href="#toc-entry-12">Configuration</a></h2>
</div>
<div class="section" id="merchant-address-configuration-required">
<h2><a class="toc-backref" href="#toc-entry-13">Merchant Address Configuration (Required)</a></h2>
<p><strong>Important</strong>: The merchant Algorand address is <strong>required</strong> to enable
or test the payment provider.</p>
<p>The module will validate that:</p>
<ol class="arabic simple">
<li><strong>Address is configured</strong>: You cannot enable the provider without
setting a merchant address</li>
<li><strong>Address format is valid</strong>: Algorand addresses must be exactly 58
characters long</li>
<li><strong>Address exists on blockchain</strong>: The address should be a valid
Algorand account</li>
</ol>
<p>To configure your merchant address:</p>
<ol class="arabic simple">
<li>Go to <strong>Website &gt; Configuration &gt; Payment Providers</strong></li>
<li>Select <strong>Algorand Pera Wallet</strong></li>
<li>In the <strong>Merchant Algorand Address</strong> field, enter your 58-character
Algorand wallet address</li>
<li>Click <strong>"Check USDC Opt-in Status"</strong> to verify your USDC
configuration (see below)</li>
</ol>
</div>
<div class="section" id="network-configuration">
<h2><a class="toc-backref" href="#toc-entry-14">Network Configuration</a></h2>
<div class="section" id="testnet-for-testing">
<h3><a class="toc-backref" href="#toc-entry-15">TestNet (for testing)</a></h3>
<p>For testing purposes, use the following configuration:</p>
<ul class="simple">
<li><strong>Network</strong>: TestNet</li>
<li><strong>Node URL</strong>: <tt class="docutils literal"><span class="pre">https://testnet-api.algonode.cloud</span></tt></li>
<li><strong>Merchant Address</strong>: Your TestNet wallet address (required)</li>
</ul>
<p>You can get free TestNet ALGO from:
<a class="reference external" href="https://bank.testnet.algorand.network/">https://bank.testnet.algorand.network/</a></p>
</div>
<div class="section" id="mainnet-for-production">
<h3><a class="toc-backref" href="#toc-entry-16">MainNet (for production)</a></h3>
<p>For production use:</p>
<ul class="simple">
<li><strong>Network</strong>: MainNet</li>
<li><strong>Node URL</strong>: <tt class="docutils literal"><span class="pre">https://mainnet-api.algonode.cloud</span></tt></li>
<li><strong>Merchant Address</strong>: Your MainNet wallet address (required, ensure
you have this address secured)</li>
</ul>
</div>
</div>
<div class="section" id="usdc-payments-usd-currency">
<h2><a class="toc-backref" href="#toc-entry-17">USDC Payments (USD Currency)</a></h2>
<p>To accept <strong>USD payments</strong> via USDC on Algorand:</p>
<p><strong>Requirement</strong>: Your merchant wallet <strong>must be opted-in</strong> to the USDC
asset.</p>
<div class="section" id="checking-usdc-opt-in-status">
<h3><a class="toc-backref" href="#toc-entry-18">Checking USDC Opt-in Status</a></h3>
<p>The module provides an automatic check:</p>
<ol class="arabic simple">
<li>Go to your Algorand Pera Wallet provider configuration</li>
<li>Click the <strong>“Check USDC Opt-in Status”</strong> button</li>
<li>The system will query the Algorand blockchain and display:<ul>
<li>✓ <strong>Success</strong>: If your address is opted-in to USDC</li>
<li>✗ <strong>Warning</strong>: If your address is NOT opted-in to USDC</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="usdc-asset-ids">
<h3><a class="toc-backref" href="#toc-entry-19">USDC Asset IDs</a></h3>
<ul class="simple">
<li><strong>MainNet USDC</strong> (Circle): Asset ID <tt class="docutils literal">31566704</tt></li>
<li><strong>TestNet USDC</strong>: Asset ID <tt class="docutils literal">10458941</tt></li>
</ul>
</div>
<div class="section" id="how-to-opt-in-to-usdc">
<h3><a class="toc-backref" href="#toc-entry-20">How to Opt-in to USDC</a></h3>
<p>To opt-in to USDC in your merchant wallet:</p>
<ol class="arabic simple">
<li>Open your Pera Wallet mobile app or web wallet</li>
<li>Go to “Add Asset” or “Asset Opt-in”</li>
<li>Search for “USDC”</li>
<li>Select the official USDC asset (verify the Asset ID matches above)</li>
<li>Complete the opt-in transaction (requires a minimal ALGO balance for
the transaction fee)</li>
</ol>
<p><strong>Note</strong>: You can always accept <strong>ALGO payments</strong> without USDC opt-in.
USDC opt-in is only required for USD currency payments.</p>
</div>
</div>
<div class="section" id="validation-and-error-handling">
<h2><a class="toc-backref" href="#toc-entry-21">Validation and Error Handling</a></h2>
<p>The module performs the following validations:</p>
<p><strong>When Enabling the Provider</strong>:</p>
<ul class="simple">
<li>✓ Merchant address must be configured</li>
<li>✓ Merchant address must be exactly 58 characters</li>
<li>✓ Address format must be valid</li>
</ul>
<p><strong>During Payment Processing</strong>:</p>
<ul class="simple">
<li>✓ System checks customer wallet USDC opt-in for USD payments</li>
<li>✓ System checks merchant wallet USDC opt-in for USD payments</li>
<li>✓ Customers are prompted to opt-in if needed</li>
<li>✓ Clear error messages are displayed if requirements are not met</li>
</ul>
</div>
<div class="section" id="security-considerations">
<h2><a class="toc-backref" href="#toc-entry-22">Security Considerations</a></h2>
<ul class="simple">
<li><strong>Never share your private keys</strong>: Pera Wallet handles signing on the
customer side</li>
<li><strong>Verify merchant address</strong>: Double-check your merchant address
configuration using the validation buttons</li>
<li><strong>Test thoroughly</strong>: Always test on TestNet before going live on
MainNet</li>
<li><strong>Monitor transactions</strong>: Set up monitoring for incoming payments</li>
<li><strong>Keep backups</strong>: Maintain secure backups of your wallet recovery
phrase</li>
<li><strong>Verify USDC opt-in</strong>: Always check your USDC opt-in status before
accepting USD payments</li>
</ul>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#toc-entry-23">Usage</a></h2>
</div>
<div class="section" id="customer-experience">
<h2><a class="toc-backref" href="#toc-entry-24">Customer Experience</a></h2>
<p>When a customer selects Algorand Pera Wallet as their payment method:</p>
<ol class="arabic simple">
<li>The payment form displays the payment details (amount, merchant
address)</li>
<li>Customer clicks “Connect Wallet” to connect their Pera Wallet</li>
<li>Pera Wallet prompts the customer to approve the connection</li>
<li>Once connected, the customer’s wallet address is displayed</li>
<li>For USDC payments, the system automatically checks if the customer
needs to opt-in to USDC</li>
<li>Customer clicks “Pay Now”</li>
<li>Pera Wallet prompts the customer to sign and approve the transaction</li>
<li>Transaction is broadcast to the Algorand blockchain</li>
<li>Payment is confirmed within seconds (typically under 5 seconds)</li>
<li>Customer is redirected to /payment/status page showing payment
confirmation</li>
<li>Order is automatically confirmed and customer receives order
confirmation</li>
<li>Cart is automatically cleared when customer navigates to shop</li>
</ol>
</div>
<div class="section" id="payment-flow-architecture">
<h2><a class="toc-backref" href="#toc-entry-25">Payment Flow Architecture</a></h2>
<p>The payment process follows Odoo’s standard payment provider flow:</p>
<p><strong>Frontend (Customer Side)</strong>:</p>
<ol class="arabic simple">
<li><strong>Transaction Initialization</strong>: Customer selects Algorand payment
method</li>
<li><strong>Wallet Connection</strong>: Pera Wallet SDK connects to customer’s wallet</li>
<li><strong>Transaction Building</strong>: Module constructs Algorand transaction
(payment or ASA transfer)</li>
<li><strong>Transaction Signing</strong>: Customer signs transaction in Pera Wallet
(private keys never leave wallet)</li>
<li><strong>Blockchain Broadcast</strong>: Signed transaction is broadcast to Algorand
network</li>
<li><strong>Backend Notification</strong>: Frontend sends transaction hash to backend</li>
</ol>
<p><strong>Backend (Server Side)</strong>:</p>
<ol class="arabic simple">
<li><strong>Transaction Processing</strong>: <tt class="docutils literal">_process()</tt> method updates transaction
state</li>
<li><strong>Transaction Monitoring</strong>: <tt class="docutils literal">monitor_transaction()</tt> registers tx
for status page</li>
<li><strong>Order Confirmation</strong>: Sale order is confirmed (state: draft → sale)</li>
<li><strong>Session Management</strong>: Session is explicitly saved for status page</li>
<li><strong>Post-Processing</strong>: Odoo’s cron handles payment creation and invoice
reconciliation</li>
</ol>
<p><strong>Automatic Cart Clearing</strong>:</p>
<ul class="simple">
<li>When order is confirmed (state != ‘draft’), it’s no longer a cart</li>
<li>Customer navigates to /shop or /shop/cart</li>
<li>website_sale controller detects order.state != ‘draft’</li>
<li>session[‘sale_order_id’] is automatically cleared</li>
<li>Cart badge updates via page reload (no manual intervention needed)</li>
</ul>
</div>
<div class="section" id="supported-payment-types">
<h2><a class="toc-backref" href="#toc-entry-26">Supported Payment Types</a></h2>
<p><strong>ALGO Payments</strong> (Native Cryptocurrency):</p>
<ul class="simple">
<li>Direct payments in Algorand’s native token</li>
<li>No asset opt-in required</li>
<li>Supported for any currency configured to use ALGO</li>
<li>Fastest option with minimal setup</li>
</ul>
<p><strong>USDC Payments</strong> (USD Stablecoin):</p>
<ul class="simple">
<li>Payments using Circle’s USDC on Algorand</li>
<li>Requires both merchant AND customer to be opted-in to USDC asset</li>
<li>Automatic opt-in status verification</li>
<li>Clear user prompts if opt-in is needed</li>
<li>Supported for USD currency only</li>
</ul>
</div>
<div class="section" id="transaction-verification">
<h2><a class="toc-backref" href="#toc-entry-27">Transaction Verification</a></h2>
<p>All payments are cryptographically verified on the Algorand blockchain,
ensuring:</p>
<ul class="simple">
<li><strong>Payment Authenticity</strong>: Transaction signature verified by blockchain</li>
<li><strong>Correct Amount</strong>: Blockchain ensures exact amount was transferred</li>
<li><strong>Correct Recipient</strong>: Payment to merchant’s configured address</li>
<li><strong>Immutability</strong>: Transaction cannot be reversed or modified</li>
<li><strong>Fast Finality</strong>: Confirmed in one block (~3.7 seconds)</li>
</ul>
</div>
<div class="section" id="error-handling">
<h2><a class="toc-backref" href="#toc-entry-28">Error Handling</a></h2>
<p>The module provides comprehensive error handling:</p>
<p><strong>Pre-Payment Validation</strong>:</p>
<ul class="simple">
<li>✓ Wallet connection status</li>
<li>✓ Merchant address configuration</li>
<li>✓ USDC opt-in for USD payments (both merchant and customer)</li>
<li>✓ Sufficient balance in customer wallet</li>
</ul>
<p><strong>Payment Processing Errors</strong>:</p>
<ul class="simple">
<li>Insufficient funds → Clear message to add more funds</li>
<li>Transaction broadcast failure → Retry option</li>
<li>Network connectivity issues → User-friendly error messages</li>
<li>Wallet connection lost → Reconnection prompt</li>
</ul>
<p><strong>Post-Payment</strong>:</p>
<ul class="simple">
<li>Session persistence for status page</li>
<li>Automatic transaction monitoring</li>
<li>Order confirmation with error recovery</li>
<li>Failed payments marked as ‘error’ state</li>
</ul>
</div>
<div class="section" id="admin-features">
<h2><a class="toc-backref" href="#toc-entry-29">Admin Features</a></h2>
<p><strong>Payment Provider Configuration</strong>:</p>
<ul class="simple">
<li>Merchant address validation (58 characters, valid format)</li>
<li>Network selection (TestNet/MainNet)</li>
<li>Node URL configuration with verification button</li>
<li>USDC opt-in status checker</li>
<li>Real-time blockchain verification</li>
</ul>
<p><strong>Transaction Management</strong>:</p>
<ul class="simple">
<li>Algorand transaction ID stored on payment.transaction</li>
<li>Sender address tracking</li>
<li>Network information (testnet/mainnet)</li>
<li>Provider reference linked to blockchain transaction</li>
<li>Full audit trail in transaction chatter</li>
</ul>
<p><strong>Debugging Tools</strong>:</p>
<ul class="simple">
<li>Comprehensive logging at all stages</li>
<li>Transaction state tracking</li>
<li>Frontend console logging for development</li>
<li>Blockchain explorer links for transaction verification</li>
</ul>
</div>
<div class="section" id="security-best-practices">
<h2><a class="toc-backref" href="#toc-entry-30">Security Best Practices</a></h2>
<p><strong>For Merchants</strong>:</p>
<ul class="simple">
<li>✓ Never share your wallet’s private keys or recovery phrase</li>
<li>✓ Use the USDC opt-in checker to verify configuration</li>
<li>✓ Test thoroughly on TestNet before MainNet deployment</li>
<li>✓ Monitor incoming transactions regularly</li>
<li>✓ Keep secure backups of wallet recovery phrase</li>
<li>✓ Verify merchant address in configuration matches your wallet</li>
</ul>
<p><strong>For Customers</strong>:</p>
<ul class="simple">
<li>✓ Always verify payment details before signing</li>
<li>✓ Check merchant address matches expected recipient</li>
<li>✓ Verify payment amount in Pera Wallet</li>
<li>✓ Keep Pera Wallet app updated</li>
<li>✓ Use secure device for transactions</li>
</ul>
</div>
<div class="section" id="changelog">
<h2><a class="toc-backref" href="#toc-entry-31">Changelog</a></h2>
</div>
<div class="section" id="section-1">
<h2><a class="toc-backref" href="#toc-entry-32">19.0.1.0.0 (2025-10-17)</a></h2>
<p><strong>Initial Release - Production Ready</strong></p>
<div class="section" id="core-features">
<h3><a class="toc-backref" href="#toc-entry-33">Core Features:</a></h3>
<ul class="simple">
<li>Support for ALGO payments via Pera Wallet</li>
<li>Support for USDC payments (Algorand Standard Asset)</li>
<li>Direct blockchain payment verification</li>
<li>Automatic order confirmation upon payment</li>
<li>TestNet and MainNet support</li>
<li>Merchant address validation with blockchain verification</li>
<li>USDC opt-in status checker for merchant and customer</li>
</ul>
</div>
<div class="section" id="payment-flow">
<h3><a class="toc-backref" href="#toc-entry-34">Payment Flow:</a></h3>
<ul class="simple">
<li>Follows Odoo’s standard payment provider architecture</li>
<li>Automatic cart clearing after successful payment</li>
<li>Transaction monitoring on /payment/status page</li>
<li>Session persistence for reliable redirects</li>
<li>Comprehensive error handling and user feedback</li>
</ul>
</div>
<div class="section" id="code-quality">
<h3><a class="toc-backref" href="#toc-entry-35">Code Quality:</a></h3>
<ul class="simple">
<li>Removed all external code references</li>
<li>Added comprehensive inline documentation</li>
<li>Followed Odoo’s standard payment patterns</li>
<li>OCA compliant module structure</li>
<li>~200 lines of zombie code removed for maintainability</li>
</ul>
</div>
<div class="section" id="technical-implementation">
<h3><a class="toc-backref" href="#toc-entry-36">Technical Implementation:</a></h3>
<ul class="simple">
<li>Pera Wallet Connect SDK integration</li>
<li>JSON-RPC API communication</li>
<li>Automatic transaction state management</li>
<li>Post-processing via Odoo’s standard cron</li>
<li>Race condition prevention through proper session handling</li>
</ul>
</div>
<div class="section" id="security-validation">
<h3><a class="toc-backref" href="#toc-entry-37">Security &amp; Validation:</a></h3>
<ul class="simple">
<li>Merchant address format validation (58 characters)</li>
<li>USDC opt-in verification for both parties</li>
<li>Blockchain transaction verification</li>
<li>Secure wallet connection via Pera Wallet</li>
<li>No private key handling (non-custodial)</li>
</ul>
</div>
<div class="section" id="admin-features-1">
<h3><a class="toc-backref" href="#toc-entry-38">Admin Features:</a></h3>
<ul class="simple">
<li>Network configuration (TestNet/MainNet)</li>
<li>Node URL verification button</li>
<li>USDC opt-in status checker</li>
<li>Transaction tracking with blockchain IDs</li>
<li>Comprehensive logging for debugging</li>
</ul>
</div>
<div class="section" id="documentation">
<h3><a class="toc-backref" href="#toc-entry-39">Documentation:</a></h3>
<ul class="simple">
<li>Complete installation guide</li>
<li>Step-by-step configuration instructions</li>
<li>Usage documentation with flow diagrams</li>
<li>Security best practices</li>
<li>OCA contribution guidelines compliant</li>
</ul>
</div>
</div>
<div class="section" id="bug-tracker">
<h2><a class="toc-backref" href="#toc-entry-40">Bug Tracker</a></h2>
<p>Bugs are tracked on <a class="reference external" href="https://github.com/OCA/algobizsuite/issues">GitHub Issues</a>.
In case of trouble, please check there if your issue has already been reported.
If you spotted it first, help us to smash it by providing a detailed and welcomed
<a class="reference external" href="https://github.com/OCA/algobizsuite/issues/new?body=module:%20algorand_pera_payment%0Aversion:%2019.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**">feedback</a>.</p>
<p>Do not contact contributors directly about support or help with technical issues.</p>
</div>
<div class="section" id="credits">
<h2><a class="toc-backref" href="#toc-entry-41">Credits</a></h2>
<div class="section" id="contributors">
<h3><a class="toc-backref" href="#toc-entry-42">Contributors</a></h3>
<ul class="simple">
<li>Your Name <a class="reference external" href="mailto:your.email&#64;example.com">your.email&#64;example.com</a></li>
</ul>
</div>
<div class="section" id="maintainers">
<h3><a class="toc-backref" href="#toc-entry-43">Maintainers</a></h3>
<p>This module is maintained by the OCA.</p>
<a class="reference external image-reference" href="https://odoo-community.org">
<img alt="Odoo Community Association" src="https://odoo-community.org/logo.png" />
</a>
<p>OCA, or the Odoo Community Association, is a nonprofit organization whose
mission is to support the collaborative development of Odoo features and
promote its widespread use.</p>
<p>This module is part of the <a class="reference external" href="https://github.com/OCA/algobizsuite/tree/19.0/algorand_pera_payment">OCA/algobizsuite</a> project on GitHub.</p>
<p>You are welcome to contribute. To learn how please visit <a class="reference external" href="https://odoo-community.org/page/Contribute">https://odoo-community.org/page/Contribute</a>.</p>
</div>
</div>
</div>
</div>
</body>
</html>
